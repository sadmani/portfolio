---
layout: project
title: Center of Pressure Detection
date: September 1, 2015
image: http://unsplash.it/400?random
---

## Overview

[include a picture of the prototype]

The goal of this project is create a prototype for a device that is portable and can measure the center of pressure of each foot throughout the gait cycle. Center of pressure (CoP) tells you where the ground reaction force vector is applied; the center of pressure is especially important for biomechanical applications because it can provide important information about posture and gait. CoP changes throughout the gait cycle, starting off at the heel during heel strike moving along the foot and ending at the toes during toe-off.

Contemporary methods for measuring the center of pressure are very expensive, bulky, and not robust. Throughout the summer with the aim of alleviating those issues. Though I did not get a chance to research a different avenue of this project that would be much less bulky and potentially more robust, it is still something that I wish to do further research and development on. The current prototype was developed by extracting sensors from an old bathroom scale, designing a circuit that would amplify the signal while protecting from environmental noise, center of pressure calculations, and a way to visualize this data for further analysis using serial communcation between Matlab and the PIC32.

[insert flow diagram and allow it to be clicked on for a video]

###Project requirements:

..*Durable:
	The device should last at minimum about 6 months of every day use or one that is cheap and easy enough to replace over a smaller timespan
..*Accurate:
	Following the standards for accuracy of weight scales, the device should be accurate to 1% of the full scale reading
	*Note: linearity, repeatability, and uncertainty of the sensor measurement all contribute to how accurate the device is
..*Lightweight:
	The device should not add too much 
..*Low-cost:
	Current CoP measurement devices are in the $15,000 range. Ultimately, we would like to make a device this a tenth of that cost or less 

###Major steps involved:

1. Research potential options for force sensors:

*..Hall effect sensor:
*..Force Sensitive Resistor (FSR):
	There are some potential issues with the FSRs for this particular use case. A force sensitive resistor, as the name indicates, changes resistance proportional to the amount of force applied. However, these sensors are not very robust and are good at telling that a force is applied at a location, but not really at discriminating between what *amount* of force is applied there.

*..Piezoelectric Force and Strain Sensor:
	This sensor is not a long term solution because the signal generated by the quartz core decays over time.

*..Conductive Fabric:
	I knew it was a long shot, but I was still curious as to how linear this sensor would perform in terms of whether its resistance would change linearly in response to a force input; testing indicated the input/output relationship was far from linear; though there are ways to deal with non-linear sensor signals, this is one use case in which sensor linearity is a very important factor.

*..Strain Gauge:
	This was by far the only sensor that was robust, cheap, and extremely linear. For the first stage prototype, this was a good way to move forward.

2. Take apart a bathroom scale:

![alt text](https://github.com/adam-p/markdown-here/raw/master/src/common/images/icon48.png "Image reference: http://guideimg.alibaba.com/images/shop/2015/07/22/83/health-o-meter-hdr900kd01-digital-scale-with-led-display_6104383.jpeg")

3. Make a simple prototype for use for testing sensors

Start with wood


4. Design external circuitry that will help utilize signal from new sensors

[insert circuit diagram and highlight certain components]

components:

*..Operational Amplifier (LM358):

The output from the strain gauges provide the non-inverting input for the op-amp; the inverting input and output of the op-amp are then connected to complete a buffer circuit with unity gain such that the signal did not change, but will be a good low impedance input to the instrumentation amplifier.

*..Instrumentation Amplifier (AD623AN):

The strain guage output signal sits at a voltage of about half the voltage powering the circuit. However, the change in the signal when force is applied is barely detectable without any amplification. The instrumentation amplfier is therefore extremely important in the amplification of the signal so changes are easier to detect.

However, the gain of the circuit must be chosen carefully in that too much amplification can lead to more noise in the circuit simply due to the amplification of it. Initially, I tryed a gain of 1000, but that was outside of the recommended range for this particular chip and also amplified the noise in the signal significantly. I chose a gain of 400, which ended up working well.

*..Low-Pass Filter:

I used the [NSCOPE as a DAQ](http://hades.mech.northwestern.edu/index.php/NScope) so I could collect data from the sensors and then do some digital signal processing in Matlab. In particular, I tried to determine what frequency the noise was at and build low pass and bandpass filters in Matlab to look at the data before and after the signal processing.

In the end, I came to the conclusion that a good cutoff frequency is about 40 Hz and used the following resistor and capacitor values to achieve that cutoff:




*..Analog-to-Digital Converter (ADC):

The ADC on the PIC32 has 10 bits of resolution, which means that it splits the voltage range of 0-3.3 V into 10 sections, with analog output values of 0 to 2^10. There are two options for usng this data after the ADC converts the voltage values it reads into bits: either convert the values back into voltage or use the bit values to calibrate. Since I calibrated my strain guages by collecting data with the NSCOPE again and processing that data in Matlab, I needed to convert back into voltage so I could use the appropriate calibration equations.


5. Calculate the Center of Pressure:

After the voltage values are obtained from each of the strain gauges and converted to corresponding weights, I used the calculation like the ones below to calculate the x and y values for CoP. I tried this prototype with 3 sensors (arranged in an isosceles triangle) and 4 sensors, with 4 giving better results.

6. Improve upon prototype 

[evolution of designs picture
